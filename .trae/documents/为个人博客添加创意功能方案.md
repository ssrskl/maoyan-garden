# 为个人博客添加创意功能方案

## 目标

* 围绕“数字花园”与日常创作，提升阅读体验、传播能力、探索乐趣与工程化品质。

* 充分利用现有 Next.js App Router、Velite MDX 管线、Tailwind/shadcn、Framer Motion 等技术栈。

* 风格与原先的风格一致

## 创意功能清单（按价值优先）

1. RSS 与 Sitemap/Robots 全套 SEO 输出

* 提供 `feed.xml`、`sitemap.xml`、`robots.txt`，增强订阅与搜索引擎收录。

1. 阅读进度条与阅读时长估算

* 在文章页顶部显示进度，文章元数据显示“预计 X 分钟”。

1. 高级搜索与关键词高亮

* 使用 Fuse/Lunr 在客户端生成索引，支持标题/描述/正文/标签；结果内关键词高亮。

1. 数字花园关系图（知识图谱）

* 新增 `/map`：基于标签与交叉链接可视化文章关系，支持筛选与动态布局。

1. 订阅与通知（Newsletter）

* 集成 Buttondown/Resend/Mailchimp，页脚加入订阅入口；新文章触达。

1. PWA 与离线阅读

* 添加 `manifest.json` 与 Service Worker，缓存最近文章与图片，移动端体验更好。

1. 系列/专题页与长文分章

* 文章可归入“系列”，系列页聚合；长文支持自动生成分章目录。

1. AI TL;DR 与要点提炼

* 文章详情提供“快速摘要”“关键要点”；后期可离线预生成存入 Velite 数据。

1. 图像相册增强（Gallery）

* 相册支持相册/标签筛选、EXIF 信息、瀑布流布局与预加载；延续现有 `react-photo-view`。

1. 快捷键与命令面板

* `Cmd/Ctrl + K` 打开命令面板（导航/搜索/跳转）；全站快捷键：`/` 搜索、`g h` 首页等。

1. 互动玩法：阅读打卡与徽章

* 记录阅读天数、系列完读等成就；页面徽章与分享卡片。

1. 可访问性与微交互

* 键盘导航、跳转链接、聚焦可见、类微交互动效（按钮/卡片轻动），保持性能稳健。

## 与现有代码的衔接点

* 文章页渲染：`app/blog/[...slug]/post-content.tsx:55-147`（MDX 内容、评论、目录、分享）

* MDX 运行时：`components/mdx-components.tsx:68-73`（`MDXContent` 装配组件）

* 搜索接口：`app/api/search/route.ts:5-34`（基于 Velite posts 的后端过滤）

* 全局布局与主题：`app/layout.tsx:31-47`（`Providers`、Header/Footer）、`components/providers.tsx:11-19`

* 内容管线：`velite.config.ts:12-30`（posts 集合定义，支持新增字段与 remark/rehype 插件）

## 近期优先实施（Phase 1-3）

### Phase 1：SEO 与基础能力

* 新增 `app/sitemap.ts` 自动输出包含文章/标签/归档的 sitemap。

* 新增 `app/robots.txt` 允许抓取并声明 `Sitemap` 位置。

* 新增 RSS 生成逻辑：以 Velite `posts` 构建 `/feed.xml`，含标题/描述/链接/日期/标签。

### Phase 2：阅读体验升级

* 阅读进度条：在 `post-content.tsx` 顶部监听滚动，渲染进度条；不影响现有 `返回顶部` 逻辑。

* 阅读时长估算：Velite 构建阶段计算 `readingTime`（按中文/英文词数与图片数估算），在文章元信息展示。

### Phase 3：搜索增强

* 客户端索引：构建时生成精简索引（title/desc/tags/部分正文），前端引入 Fuse/Lunr。

* UI：复用 `app/search/search-content.tsx:47-95`，新增“关键词高亮”“标签过滤”“按时间/相关度排序”。

## 后续阶段（Phase 4-7）

### Phase 4：知识图谱

* 新增 `/map` 页面：D3/`vis-network` 实现标签与文章的力导图，可按标签筛选。

* Velite remark 插件：解析 MDX 内部链接与引用，增强图谱边的语义。

### Phase 5：订阅与通知

* 页脚添加订阅输入与 `api/subscribe` 路由，后端调用邮件服务；文章发布触发邮件。

### Phase 6：PWA

* 加入 `manifest.json`、`app/icon.png`、注册 Service Worker，缓存关键资源与最近文章。

### Phase 7：系列/专题与长文分章

* 在 Velite `posts` 中新增 `series` 字段；生成 `/series/[name]` 聚合页。

* 长文自动目录与分章跳转，移动端优化。

## 技术实现要点

* 保持静态站点与增量静态再生（ISR）兼容；敏感功能走 `app/api/**` 边缘路由。

* Velite 扩展字段：如 `readingTime`、`series`、`summary`；统一输出到 `@/.velite` 数据源。

* 依赖评估：Fuse.js、D3/vis-network、next-pwa 或手工 SW；尽量轻依赖，按需加载。

* UI 一致性：基于 shadcn 组件与现有 Tailwind 主题变量；动画用 Framer Motion 珍惜使用。

## 预估工作量

* Phase 1：0.5-1 天

* Phase 2：0.5 天

* Phase 3：1 天

* Phase 4：1.5-2 天

* Phase 5：1 天

* Phase 6：0.5-1 天

* Phase 7：0.5 天

## 需要确认

* 只先上线知识图谱

* 知识图谱数据来源：仅标签与交叉链接即可

